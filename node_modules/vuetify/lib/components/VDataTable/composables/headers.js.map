{"version":3,"file":"headers.js","names":["capitalize","inject","provide","ref","watchEffect","consoleError","propsFactory","makeDataTableHeaderProps","headers","Array","VDataTableHeadersSymbol","Symbol","for","defaultHeader","title","sortable","defaultActionHeader","width","priorityQueue","arr","arguments","length","undefined","queue","map","element","priority","enqueue","added","i","item","splice","push","size","count","whole","Math","floor","dequeue","shift","extractLeaves","columns","children","child","extractKeys","keys","Set","key","add","getDefaultItem","includes","getDepth","depth","max","parseFixedColumns","items","seenFixed","setFixed","side","parentFixedSide","fixed","orderedChildren","toReversed","lastFixed","firstFixedEnd","isNaN","Number","minWidth","setFixedOffset","offset","fixedOffset","parseFloat","setFixedEndOffset","fixedEndOffset","parse","maxDepth","currentDepth","rowSize","row","fraction","diff","rowspan","colspan","sort","pow","flat","convertToInternalHeaders","internalHeaders","defaultItem","value","internalItem","createHeaders","props","options","sortFunctions","sortRawFunctions","filterFunctions","_headers","Object","slice","groupBy","has","unshift","showSelect","showExpand","parsed","flatHeaders","header","sortRaw","filter","data","useHeaders","Error"],"sources":["../../../../src/components/VDataTable/composables/headers.ts"],"sourcesContent":["// Utilities\nimport { capitalize, inject, provide, ref, watchEffect } from 'vue'\nimport { consoleError, propsFactory } from '@/util'\n\n// Types\nimport type { DeepReadonly, InjectionKey, PropType, Ref } from 'vue'\nimport type { SortItem } from './sort'\nimport type { DataTableCompareFunction, DataTableHeader, InternalDataTableHeader } from '../types'\nimport type { FilterKeyFunctions } from '@/composables/filter'\n\nexport const makeDataTableHeaderProps = propsFactory({\n  headers: Array as PropType<DeepReadonly<DataTableHeader[]>>,\n}, 'DataTable-header')\n\nexport const VDataTableHeadersSymbol: InjectionKey<{\n  headers: Ref<InternalDataTableHeader[][]>\n  columns: Ref<InternalDataTableHeader[]>\n}> = Symbol.for('vuetify:data-table-headers')\n\ntype HeaderProps = {\n  headers: DeepReadonly<DataTableHeader[]> | undefined\n  items: any[]\n}\n\nconst defaultHeader = { title: '', sortable: false }\nconst defaultActionHeader = { ...defaultHeader, width: 48 }\n\nfunction priorityQueue <T> (arr: T[] = []) {\n  const queue: { element: T, priority: number }[] = arr.map(element => ({ element, priority: 0 }))\n\n  return {\n    enqueue: (element: T, priority: number) => {\n      let added = false\n      for (let i = 0; i < queue.length; i++) {\n        const item = queue[i]\n        if (item.priority > priority) {\n          queue.splice(i, 0, { element, priority })\n          added = true\n          break\n        }\n      }\n\n      if (!added) queue.push({ element, priority })\n    },\n    size: () => queue.length,\n    count: () => {\n      let count = 0\n\n      if (!queue.length) return 0\n\n      const whole = Math.floor(queue[0].priority)\n      for (let i = 0; i < queue.length; i++) {\n        if (Math.floor(queue[i].priority) === whole) count += 1\n      }\n\n      return count\n    },\n    dequeue: () => {\n      return queue.shift()\n    },\n  }\n}\n\nfunction extractLeaves (item: InternalDataTableHeader, columns: InternalDataTableHeader[] = []) {\n  if (!item.children) {\n    columns.push(item)\n  } else {\n    for (const child of item.children) {\n      extractLeaves(child, columns)\n    }\n  }\n\n  return columns\n}\n\nfunction extractKeys (headers: DeepReadonly<DataTableHeader[]>, keys = new Set<string>()) {\n  for (const item of headers) {\n    if (item.key) keys.add(item.key)\n\n    if (item.children) {\n      extractKeys(item.children, keys)\n    }\n  }\n\n  return keys\n}\n\nfunction getDefaultItem (item: DeepReadonly<DataTableHeader>) {\n  if (!item.key) return undefined\n  if (item.key === 'data-table-group') return defaultHeader\n  if (['data-table-expand', 'data-table-select'].includes(item.key)) return defaultActionHeader\n  return undefined\n}\n\nfunction getDepth (item: InternalDataTableHeader, depth = 0): number {\n  if (!item.children) return depth\n\n  return Math.max(depth, ...item.children.map(child => getDepth(child, depth + 1)))\n}\n\nfunction parseFixedColumns (items: InternalDataTableHeader[]) {\n  let seenFixed = false\n\n  function setFixed (\n    item: InternalDataTableHeader,\n    side: 'start' | 'end',\n    parentFixedSide: 'start' | 'end' | 'none' = 'none'\n  ) {\n    if (!item) return\n\n    if (parentFixedSide !== 'none') {\n      item.fixed = parentFixedSide\n    }\n\n    // normalize to simplify logic below\n    if (item.fixed === true) {\n      item.fixed = 'start'\n    }\n\n    const orderedChildren = side === 'start'\n      ? item.children?.toReversed()\n      : item.children\n\n    if (item.fixed === side) {\n      if (orderedChildren) {\n        for (const child of orderedChildren) {\n          setFixed(child, side, side)\n        }\n      } else {\n        if (!seenFixed && side === 'start') {\n          item.lastFixed = true\n        } else if (!seenFixed && side === 'end') {\n          item.firstFixedEnd = true\n        } else if (isNaN(Number(item.width))) {\n          consoleError(`Multiple fixed columns should have a static width (key: ${item.key})`)\n        } else {\n          item.minWidth = Math.max(Number(item.width) || 0, Number(item.minWidth) || 0)\n        }\n        seenFixed = true\n      }\n    } else {\n      if (orderedChildren) {\n        for (const child of orderedChildren) {\n          setFixed(child, side)\n        }\n      } else {\n        seenFixed = false\n      }\n    }\n  }\n\n  for (const item of items.toReversed()) {\n    setFixed(item, 'start')\n  }\n\n  for (const item of items) {\n    setFixed(item, 'end')\n  }\n\n  function setFixedOffset (item: InternalDataTableHeader, offset = 0) {\n    if (!item) return offset\n\n    if (item.children) {\n      item.fixedOffset = offset\n      for (const child of item.children) {\n        offset = setFixedOffset(child, offset)\n      }\n    } else if (item.fixed && item.fixed !== 'end') {\n      item.fixedOffset = offset\n      offset += parseFloat(item.width || '0') || 0\n    }\n\n    return offset\n  }\n\n  let fixedOffset = 0\n  for (const item of items) {\n    fixedOffset = setFixedOffset(item, fixedOffset)\n  }\n\n  function setFixedEndOffset (item: InternalDataTableHeader, offset = 0) {\n    if (!item) return offset\n\n    if (item.children) {\n      item.fixedEndOffset = offset\n      for (const child of item.children) {\n        offset = setFixedEndOffset(child, offset)\n      }\n    } else if (item.fixed === 'end') {\n      item.fixedEndOffset = offset\n      offset += parseFloat(item.width || '0') || 0\n    }\n\n    return offset\n  }\n\n  let fixedEndOffset = 0\n  for (const item of items.toReversed()) {\n    fixedEndOffset = setFixedEndOffset(item, fixedEndOffset)\n  }\n}\n\nfunction parse (items: InternalDataTableHeader[], maxDepth: number) {\n  const headers: InternalDataTableHeader[][] = []\n  let currentDepth = 0\n  const queue = priorityQueue(items)\n\n  while (queue.size() > 0) {\n    let rowSize = queue.count()\n    const row: InternalDataTableHeader[] = []\n    let fraction = 1\n    while (rowSize > 0) {\n      const { element: item, priority } = queue.dequeue()!\n      const diff = maxDepth - currentDepth - getDepth(item)\n\n      row.push({\n        ...item,\n        rowspan: diff ?? 1,\n        colspan: item.children ? extractLeaves(item).length : 1,\n      })\n\n      if (item.children) {\n        for (const child of item.children) {\n          // This internally sorts items that are on the same priority \"row\"\n          const sort = priority % 1 + (fraction / Math.pow(10, currentDepth + 2))\n          queue.enqueue(child, currentDepth + diff + sort)\n        }\n      }\n\n      fraction += 1\n      rowSize -= 1\n    }\n    currentDepth += 1\n    headers.push(row)\n  }\n\n  const columns = items.map(item => extractLeaves(item)).flat()\n\n  return { columns, headers }\n}\n\nfunction convertToInternalHeaders (items: DeepReadonly<DataTableHeader[]>) {\n  const internalHeaders: InternalDataTableHeader[] = []\n  for (const item of items) {\n    const defaultItem = { ...getDefaultItem(item), ...item }\n    const key = defaultItem.key ?? (typeof defaultItem.value === 'string' ? defaultItem.value : null)\n    const value = defaultItem.value ?? key ?? null\n    const internalItem: InternalDataTableHeader = {\n      ...defaultItem,\n      key,\n      value,\n      sortable: defaultItem.sortable ?? (defaultItem.key != null || !!defaultItem.sort),\n      children: defaultItem.children ? convertToInternalHeaders(defaultItem.children) : undefined,\n    }\n\n    internalHeaders.push(internalItem)\n  }\n\n  return internalHeaders\n}\n\nexport function createHeaders (\n  props: HeaderProps,\n  options?: {\n    groupBy?: Ref<readonly SortItem[]>\n    showSelect?: Ref<boolean>\n    showExpand?: Ref<boolean>\n  }\n) {\n  const headers = ref<InternalDataTableHeader[][]>([])\n  const columns = ref<InternalDataTableHeader[]>([])\n  const sortFunctions = ref<Record<string, DataTableCompareFunction>>({})\n  const sortRawFunctions = ref<Record<string, DataTableCompareFunction>>({})\n  const filterFunctions = ref<FilterKeyFunctions>({})\n\n  watchEffect(() => {\n    const _headers = props.headers ||\n      Object.keys(props.items[0] ?? {}).map(key => ({ key, title: capitalize(key) })) as never\n\n    const items = _headers.slice()\n    const keys = extractKeys(items)\n\n    if (options?.groupBy?.value.length && !keys.has('data-table-group')) {\n      items.unshift({ key: 'data-table-group', title: 'Group' })\n    }\n\n    if (options?.showSelect?.value && !keys.has('data-table-select')) {\n      items.unshift({ key: 'data-table-select' })\n    }\n\n    if (options?.showExpand?.value && !keys.has('data-table-expand')) {\n      items.push({ key: 'data-table-expand' })\n    }\n\n    const internalHeaders = convertToInternalHeaders(items)\n\n    parseFixedColumns(internalHeaders)\n\n    const maxDepth = Math.max(...internalHeaders.map(item => getDepth(item))) + 1\n    const parsed = parse(internalHeaders, maxDepth)\n\n    headers.value = parsed.headers\n    columns.value = parsed.columns\n\n    const flatHeaders = parsed.headers.flat(1)\n\n    for (const header of flatHeaders) {\n      if (!header.key) continue\n\n      if (header.sortable) {\n        if (header.sort) {\n          sortFunctions.value[header.key] = header.sort\n        }\n\n        if (header.sortRaw) {\n          sortRawFunctions.value[header.key] = header.sortRaw\n        }\n      }\n\n      if (header.filter) {\n        filterFunctions.value[header.key] = header.filter\n      }\n    }\n  })\n\n  const data = { headers, columns, sortFunctions, sortRawFunctions, filterFunctions }\n\n  provide(VDataTableHeadersSymbol, data)\n\n  return data\n}\n\nexport function useHeaders () {\n  const data = inject(VDataTableHeadersSymbol)\n\n  if (!data) throw new Error('Missing headers!')\n\n  return data\n}\n"],"mappings":"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","ignoreList":[]}