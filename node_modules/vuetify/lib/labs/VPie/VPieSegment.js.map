{"version":3,"file":"VPieSegment.js","names":["makeRevealProps","useReveal","computed","shallowRef","toRef","useInnerSlicePath","useOuterSlicePath","usePieArc","easingPatterns","genericComponent","propsFactory","useTransition","makeVPieSegmentProps","rotate","Number","String","value","type","default","color","innerCut","hoverScale","gap","rounded","animation","Boolean","Object","pattern","hideSlice","VPieSegment","name","props","setup","isHovering","state","revealState","duration","revealDuration","transitionConfig","defaultEasing","defaultDuration","easingName","easing","includes","transition","hoverZoomRatio","normalizedValue","normalizedInnerCut","outerX","outerY","arcWidth","arcSize","currentArcSize","angle","currentAngle","arcRadius","currentArcRadius","currentArcWidth","outerSlicePath","radius","size","width","innerSlicePath","overlayPath","_createElementVNode","onMouseenter","onMouseleave"],"sources":["../../../src/labs/VPie/VPieSegment.tsx"],"sourcesContent":["// Composables\nimport { makeRevealProps, useReveal } from '@/composables/reveal'\n\n// Utilities\nimport { computed, shallowRef, toRef } from 'vue'\nimport { useInnerSlicePath, useOuterSlicePath, usePieArc } from './utils'\nimport { easingPatterns, genericComponent, propsFactory, useTransition } from '@/util'\n\n// Types\nimport type { PropType } from 'vue'\n\nexport const makeVPieSegmentProps = propsFactory({\n  rotate: [Number, String],\n  value: {\n    type: Number,\n    default: 0,\n  },\n  color: String,\n  innerCut: [Number, String],\n  hoverScale: {\n    type: [Number, String],\n    default: 0.05,\n  },\n  gap: [Number, String],\n  rounded: [Number, String],\n  animation: {\n    type: [Boolean, Object] as PropType<boolean | {\n      duration?: number\n      easing?: keyof typeof easingPatterns\n    }>,\n    default: false,\n  },\n  pattern: String,\n  hideSlice: Boolean,\n  ...makeRevealProps(),\n}, 'VPieSegment')\n\nexport const VPieSegment = genericComponent()({\n  name: 'VPieSegment',\n\n  props: makeVPieSegmentProps(),\n\n  setup (props) {\n    const isHovering = shallowRef(false)\n\n    const { state: revealState, duration: revealDuration } = useReveal(props)\n\n    const transitionConfig = computed(() => {\n      const defaultEasing = 'easeInOutCubic'\n      const defaultDuration = 400\n\n      const easingName = typeof props.animation === 'object'\n        ? props.animation.easing ?? defaultEasing\n        : defaultEasing\n\n      return {\n        duration: ['initial', 'pending'].includes(revealState.value)\n          ? revealDuration.value\n          : typeof props.animation === 'object'\n            ? props.animation.duration\n            : (props.animation ? defaultDuration : 0),\n        transition: easingPatterns[easingName],\n      }\n    })\n\n    const {\n      hoverZoomRatio,\n      normalizedValue,\n      normalizedInnerCut,\n      outerX,\n      outerY,\n      arcWidth,\n    } = usePieArc(props, isHovering)\n\n    const arcSize = toRef(() => revealState.value === 'initial' ? 0 : normalizedValue.value)\n    const currentArcSize = useTransition(arcSize, transitionConfig)\n\n    const angle = toRef(() => revealState.value === 'initial' ? 0 : (Number(props.rotate ?? 0) + Number(props.gap ?? 0) / 2))\n    const currentAngle = useTransition(angle, transitionConfig)\n\n    const arcRadius = toRef(() => 50 * (isHovering.value ? 1 : (1 - hoverZoomRatio.value)))\n    const currentArcRadius = useTransition(arcRadius, transitionConfig)\n    const currentArcWidth = useTransition(arcWidth, transitionConfig)\n\n    const outerSlicePath = useOuterSlicePath({\n      angle: currentAngle,\n      radius: currentArcRadius,\n      size: currentArcSize,\n      width: currentArcWidth,\n      rounded: () => Number(props.rounded ?? 0),\n    })\n\n    const innerSlicePath = useInnerSlicePath({\n      angle: currentAngle,\n      radius: () => currentArcRadius.value - currentArcWidth.value,\n      size: currentArcSize,\n    })\n\n    const overlayPath = toRef(() => `M 50 0 A 50 50 0 ${normalizedValue.value > 50 ? 1 : 0} 1 ${outerX.value} ${outerY.value} L 50 50`)\n\n    return () => (\n      <g\n        class=\"v-pie-segment\"\n        style={{ color: props.color }}\n      >\n        <path\n          key=\"outer-slice\"\n          fill=\"currentColor\"\n          shape-rendering=\"geometricPrecision\"\n          d={ outerSlicePath.value }\n        />\n        { props.pattern && (\n          <path\n            key=\"pattern-overlay\"\n            shape-rendering=\"geometricPrecision\"\n            fill={ props.pattern }\n            d={ outerSlicePath.value }\n          />\n        )}\n        { !props.hideSlice && normalizedInnerCut.value > 0 && (\n          <path\n            key=\"inner-slice\"\n            fill=\"oklch(from currentColor l c h / calc(alpha / 2))\"\n            d={ innerSlicePath.value }\n          />\n        )}\n        {['disabled', 'done'].includes(revealState.value) && (\n          <path\n            transform={ `rotate(${currentAngle.value} 50 50)` }\n            class=\"v-pie-segment__overlay\"\n            d={ overlayPath.value }\n            onMouseenter={ () => isHovering.value = true }\n            onMouseleave={ () => isHovering.value = false }\n          />\n        )}\n      </g>\n    )\n  },\n})\n\nexport type VPieSegment = InstanceType<typeof VPieSegment>\n"],"mappings":"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","ignoreList":[]}